name: Ping Railway App

on:
  schedule:
    # Ch·∫°y m·ªói 5 ph√∫t
    - cron: "*/5 * * * *"
  # Cho ph√©p ch·∫°y th·ªß c√¥ng
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Railway App
        run: |
          echo "üöÄ Pinging Railway App..."
          echo "Time: $(date '+%H:%M:%S %d/%m/%Y')"
          echo "----------------------------------------"
          
          # Thay YOUR_APP_NAME b·∫±ng t√™n app Railway c·ªßa b·∫°n
          APP_URL="https://YOUR_APP_NAME.up.railway.app"
          
          # Ho·∫∑c d√πng URL t·ª´ GitHub Secrets (khuy·∫øn kh√≠ch)
          if [ -n "${{ secrets.RAILWAY_URL }}" ]; then
            APP_URL="${{ secrets.RAILWAY_URL }}"
          fi
          
          echo "üîó URL: $APP_URL"
          
          # Ping v·ªõi curl
          response=$(curl -s -o /dev/null -w "%{http_code}" --max-time 25 "$APP_URL" || echo "000")
          
          if [[ "$response" =~ ^2[0-9][0-9]$ ]] || [[ "$response" =~ ^3[0-9][0-9]$ ]]; then
            echo "‚úÖ SUCCESS - HTTP $response"
            echo "App is alive!"
          elif [ "$response" == "000" ]; then
            echo "‚ùå FAILED - Cannot connect"
            echo "App might be sleeping or down"
            exit 1
          else
            echo "‚ö†Ô∏è WARNING - HTTP $response"
            exit 1
          fi
          
          echo "----------------------------------------"
          echo "‚úÖ Ping completed successfully!"
